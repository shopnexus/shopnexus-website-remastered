enum InteractionRefType {
  Product
  Article
  Category
  Brand

  @@map("interaction_ref_type")
  @@schema("analytic")
}

model Interaction {
  id           BigInt             @id @default(autoincrement())
  account_id   BigInt // nullable for anonymous users
  session_id   String? // for anonymous tracking (cookie/session-based)
  event_type   String // e.g. view, add_to_cart, purchase
  ref_type     InteractionRefType
  ref_id       BigInt // reference to product/article/etc.
  metadata     Json? // additional data (e.g. { "duration": 12, "source": "search" })
  user_agent   String? // optional
  ip_address   String? // optional
  date_created DateTime           @default(now()) @db.Timestamptz(3)

  customer Customer @relation(fields: [account_id], references: [id], onUpdate: Cascade, onDelete: Cascade)

  @@index([account_id])
  @@index([session_id])
  @@index([event_type])
  @@index([ref_type, ref_id])
  @@map("interaction")
  @@schema("analytic")
}
